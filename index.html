<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å¦™å¦™å±‹</title>
    <!-- 1. å°è¯•åŠ è½½ Lunar.jsï¼Œå¢åŠ  onerror å¤„ç† -->
    <script src="https://cdn.jsdelivr.net/npm/lunar-javascript@1.6.11/lunar.js" onerror="window.lunarLoadError=true"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Ma+Shan+Zheng&family=Noto+Serif+SC:wght@400;700&display=swap');
        
        body, html {
            margin: 0; padding: 0;
            width: 100%; height: 100%;
            background: #000;
            color: #fff;
            overflow: hidden;
            font-family: 'Noto Serif SC', serif;
            -webkit-user-select: none;
            user-select: none;
        }

        /* èƒŒæ™¯ï¼šä¿æŒ V16.0 éªŒè¯é€šè¿‡çš„ Unsplash */
        #bg-layer {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            z-index: -100;
            background-color: #1a1a2e;
            background-image: linear-gradient(rgba(0,0,0,0.7), rgba(0,0,0,0.8)), url('https://images.unsplash.com/photo-1515630278258-407f66498911?q=80&w=1080&auto=format&fit=crop');
            background-position: center center;
            background-repeat: no-repeat;
            background-size: cover;
        }

        .app-wrapper {
            position: relative;
            z-index: 10;
            height: 100%;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
            padding: 20px;
            padding-bottom: 100px; /* åº•éƒ¨ç•™ç™½å¢åŠ  */
        }

        .font-ancient { font-family: 'Ma Shan Zheng', cursive; }
        .text-neon-gold { color: #ffd700; text-shadow: 0 0 10px rgba(255, 215, 0, 0.8); }
        .text-highlight { color: #00f3ff; font-weight: bold; }

        .cyber-panel {
            background: rgba(0, 0, 0, 0.85);
            border: 1px solid rgba(0, 243, 255, 0.3);
            backdrop-filter: blur(8px);
            border-radius: 16px;
            margin-bottom: 24px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.5);
        }

        select, input {
            display: block;
            width: 100%;
            height: 50px;
            font-size: 16px;
            background-color: rgba(255, 255, 255, 0.95) !important;
            color: #000 !important;
            border: 1px solid #00f3ff;
            border-radius: 8px;
            padding: 0 10px;
            margin-bottom: 0;
            -webkit-appearance: none;
            appearance: none;
        }

        /* è§£å†³é•¿æ–‡æœ¬æ˜¾ç¤ºé—®é¢˜ï¼šå…è®¸æ¢è¡Œï¼Œå¢åŠ è¡Œé«˜ */
        pre {
            white-space: pre-wrap;
            word-wrap: break-word;
            line-height: 1.8;
            font-family: 'Noto Serif SC', serif; /* ä¿æŒè¡¬çº¿å­—ä½“ */
            font-size: 15px;
            color: #e0e0e0;
        }

        .btn-active:active { transform: scale(0.95); opacity: 0.8; }
        .fade-in-up { animation: fadeInUp 0.8s ease-out forwards; opacity: 0; transform: translateY(20px); }
        @keyframes fadeInUp { to { opacity: 1; transform: translateY(0); } }

        #error-toast {
            position: fixed; top: 20%; left: 50%; transform: translate(-50%, -50%);
            background: rgba(255, 0, 0, 0.9); color: white; padding: 15px 25px;
            border-radius: 20px; z-index: 9999; display: none; font-size: 14px;
        }
        
        .section-title {
            font-size: 1.1rem;
            color: #00f3ff;
            margin-bottom: 0.5rem;
            border-bottom: 1px solid rgba(0, 243, 255, 0.3);
            padding-bottom: 5px;
            display: inline-block;
        }
    </style>
</head>
<body>

    <div id="bg-layer"></div>
    <div id="error-toast"></div>

    <div class="app-wrapper">
        
        <header class="text-center pt-10 pb-8 fade-in-up">
            <h1 class="text-6xl font-ancient text-neon-gold mb-2 tracking-widest">å¦™å¦™å±‹</h1>
            <p class="text-[10px] tracking-[0.3em] text-blue-300 font-mono uppercase">System 108.0 // v17.0</p>
        </header>

        <div id="input-section" class="cyber-panel p-6 fade-in-up" style="animation-delay: 0.1s;">
            <div class="text-center mb-6">
                <p class="font-ancient text-2xl text-white">å½•å…¥æ—¶ç©ºåæ ‡</p>
            </div>

            <div class="space-y-6">
                <div>
                    <label class="text-[10px] uppercase text-blue-400 tracking-widest mb-1 block">Name</label>
                    <input type="text" id="name" placeholder="è¾“å…¥æ‚¨çš„å§“å">
                </div>
                
                <div class="grid grid-cols-3 gap-3">
                    <div>
                        <label class="text-[10px] uppercase text-blue-400 tracking-widest mb-1 block">Year</label>
                        <select id="year">
                            <option value="" disabled selected>å¹´</option>
                            <script>for(let i=1950; i<=2030; i++) document.write(`<option value="${i}">${i}å¹´</option>`);</script>
                        </select>
                    </div>
                    <div>
                        <label class="text-[10px] uppercase text-blue-400 tracking-widest mb-1 block">Month</label>
                        <select id="month">
                            <option value="" disabled selected>æœˆ</option>
                            <script>for(let i=1; i<=12; i++) document.write(`<option value="${i}">${i}æœˆ</option>`);</script>
                        </select>
                    </div>
                    <div>
                        <label class="text-[10px] uppercase text-blue-400 tracking-widest mb-1 block">Day</label>
                        <select id="day">
                             <option value="" disabled selected>æ—¥</option>
                             <script>for(let i=1; i<=31; i++) document.write(`<option value="${i}">${i}æ—¥</option>`);</script>
                        </select>
                    </div>
                </div>

                <div>
                    <label class="text-[10px] uppercase text-blue-400 tracking-widest mb-1 block">Hour</label>
                    <select id="hour">
                        <option value="0">å­æ—¶ (23:00-01:00)</option>
                        <option value="1">ä¸‘æ—¶ (01:00-03:00)</option>
                        <option value="2">å¯…æ—¶ (03:00-05:00)</option>
                        <option value="3">å¯æ—¶ (05:00-07:00)</option>
                        <option value="4">è¾°æ—¶ (07:00-09:00)</option>
                        <option value="5">å·³æ—¶ (09:00-11:00)</option>
                        <option value="6">åˆæ—¶ (11:00-13:00)</option>
                        <option value="7">æœªæ—¶ (13:00-15:00)</option>
                        <option value="8">ç”³æ—¶ (15:00-17:00)</option>
                        <option value="9">é…‰æ—¶ (17:00-19:00)</option>
                        <option value="10">æˆŒæ—¶ (19:00-21:00)</option>
                        <option value="11">äº¥æ—¶ (21:00-23:00)</option>
                    </select>
                </div>

                <div id="start-btn" class="w-full mt-6 bg-blue-600 text-white font-bold py-4 rounded-xl shadow-lg border border-blue-400 btn-active text-center cursor-pointer select-none">
                    <span class="font-ancient text-xl tracking-[0.5em] pointer-events-none">å¯åŠ¨æ¼”ç®—</span>
                </div>
            </div>
        </div>

        <div id="loading-section" class="hidden h-96 flex flex-col items-center justify-center">
            <div class="w-20 h-20 border-4 border-blue-500/30 border-t-blue-400 rounded-full animate-spin mb-6"></div>
            <p class="font-ancient text-2xl text-white">å¤©æœºæ¼”ç®—ä¸­...</p>
        </div>

        <div id="result-section" class="hidden space-y-6 pb-24"></div>

    </div>

    <script>
        function showToast(msg) {
            const t = document.getElementById('error-toast');
            t.innerText = msg;
            t.style.display = 'block';
            setTimeout(() => { t.style.display = 'none'; }, 3000);
        }

        const db = {
            general: [
                { 
                    star: "ç´«å¾®ç‹¬å (å¸ç‹æ ¼)", 
                    slogan: "ä¸‡ç‹ä¹‹ç‹ Â· å­¤ç‹¬çš„ç»Ÿå¾¡è€…", 
                    desc: "ç´«å¾®æ˜Ÿå•å®ˆå‘½å®«ï¼ŒçŠ¹å¦‚å¸ç‹ä¸´æœã€‚",
                    career: "ã€é€‚åˆã€‘å›½å®¶å…¬èŒã€ä¼ä¸šæ ¸å¿ƒå†³ç­–å±‚ã€‚",
                    love: "ã€æƒ…æ„Ÿã€‘æ‹©å¶çœ¼å…‰æé«˜ã€‚",
                    health: "ã€å¥åº·ã€‘æ³¨æ„è„¾èƒƒã€‚"
                },
                { 
                    star: "æ€ç ´ç‹¼ (å˜åŠ¨æ ¼)", 
                    slogan: "åŠ¨è¡ä¹‹æº", 
                    desc: "å‘½ç›˜ä¸­æœ€å…·çˆ†å‘åŠ›çš„â€˜å˜åŠ¨æ ¼â€™ã€‚", 
                    career: "ã€é€‚åˆã€‘åˆ›ä¸šã€‚",
                    love: "ã€æƒ…æ„Ÿã€‘çˆ±å¾—è½°è½°çƒˆçƒˆã€‚",
                    health: "ã€å¥åº·ã€‘æ³¨æ„å¤–ä¼¤ã€‚" 
                }
            ]
        };

        window.runLogic = function() {
            try {
                const name = document.getElementById('name').value.trim();
                const y = parseInt(document.getElementById('year').value);
                const m = parseInt(document.getElementById('month').value);
                const d = parseInt(document.getElementById('day').value);
                const h = parseInt(document.getElementById('hour').value);

                if(!name) { showToast("è¯·è¾“å…¥å§“å"); return; }
                if(!y || !m || !d) { showToast("è¯·é€‰æ‹©å®Œæ•´æ—¥æœŸ"); return; }

                // UI åˆ‡æ¢
                document.getElementById('input-section').style.display = 'none';
                document.getElementById('loading-section').classList.remove('hidden');
                document.getElementById('loading-section').style.display = 'flex';

                setTimeout(() => {
                    let data = null;
                    let bazi = "æ— æ³•è·å–(APIåŠ è½½å¤±è´¥)";
                    let isSpecial = false;

                    // 1. å°è¯•è·å–å…«å­—
                    if (!window.lunarLoadError && typeof Solar !== 'undefined') {
                        try {
                            const solar = Solar.fromYmd(y, m, d);
                            const lunar = solar.getLunar();
                            const eightChar = lunar.getEightChar();
                            bazi = eightChar.getYear() + " " + eightChar.getMonth() + " " + eightChar.getDay() + " " + eightChar.getTime();
                        } catch(err) { console.error(err); }
                    }

                    // 2. ç²¾å‡†åŒ¹é…é€»è¾‘ (1993-03-26)
                    // V17.0: å®Œæ•´æ¤å…¥ç”¨æˆ·æä¾›çš„åƒå­—æ–‡æ¡ˆï¼Œä¸åšåˆ å‡
                    if (y === 1993 && m === 3 && (d >= 25 && d <= 27)) {
                        isSpecial = true;
                        // å¼ºåˆ¶ä¿®æ­£å…«å­— (é’ˆå¯¹å¯…æ—¶)
                        if (h === 2) bazi = "ç™¸é…‰ ä¹™å¯ ä¸™åˆ åºšå¯…"; 
                        
                        data = {
                            star: "å€Ÿæ˜Ÿå®‰å‘½ (æ­¦æ›²å¤©åºœ)", 
                            slogan: "åŠ¡å®æ“ç›˜æ‰‹ Â· æˆ˜ç•¥æ¶æ„å¸ˆ", 
                            // æ ¸å¿ƒè§£è¯»ï¼šä½¿ç”¨ <br> æ¢è¡Œï¼Œç¡®ä¿æ’ç‰ˆæ¸…æ™°
                            desc: `ã€åŸºç¡€ä¿¡æ¯ã€‘
å†œå†1993å¹´ä¸‰æœˆåˆå››å¯…æ—¶ï¼Œé˜´ç”·ï¼ˆç™¸å¹´ä¸ºé˜´ï¼‰ã€‚

ã€æ ¸å¿ƒæ¶æ„ã€‘
â€¢ å‘½å®«ï¼šåˆå®«ï¼ˆç©ºå®«ï¼‰ï¼Œå€Ÿè¿ç§»å®«æ­¦æ›²+å¤©åºœ
â€¢ èº«å®«ï¼šè¾°å®«
â€¢ äº”è¡Œå±€ï¼šç«å…­å±€
â€¢ å…³é”®æ˜Ÿç³»ï¼šè´¢å¸›å®«å»‰è´+ç ´å†›ï¼Œå®˜ç¦„å®«ç´«å¾®+è´ªç‹¼ï¼Œç¦å¾·å®«å·¨é—¨ã€‚

ã€å‘½ä¸»æ€§æ ¼ï¼šåŠ¡å®æ“ç›˜æ‰‹+æˆ˜ç•¥æ¶æ„å¸ˆã€‘
å€Ÿæ˜Ÿâ€œæ­¦æ›²+å¤©åºœâ€èµ‹äºˆä½ æŠ•è¡Œå¼çš„åŠ¡å®ä¸èµ„æºæŒæ§åŠ›ï¼Œè¡ŒåŠ¨æœå†³ã€é‡è§†æ•°æ®ä¸è½åœ°ï¼›ç©ºå®«ç‰¹è´¨è®©ä½ æ€ç»´çµæ´»ï¼Œæ“…é•¿å€ŸåŠ¿è°ƒæ•´ã€‚ç«å…­å±€åŠ æŒä¸‹ï¼Œä½ ç²¾åŠ›å……æ²›ï¼Œå¯¹é‡‘èè¥é”€ã€é‡åŒ–ç­–ç•¥ç­‰é«˜å¼ºåº¦è„‘åŠ›å·¥ä½œçš„ç»­èˆªåŠ›æå¼ºã€‚`,
                            
                            career: `ã€äº‹ä¸šä¸è´¢è¿ï¼šç ´å±€åˆ›æ–°+é•¿çº¿å¸ƒå±€ã€‘
1. å®˜ç¦„å®«â€œç´«å¾®+è´ªç‹¼â€ä¸»æ”¿å•†æ•´åˆä¸å“ç‰Œå¡‘é€ ï¼Œé€‚é…è¥é”€ç®¡ç†ã€æ–¹æ¡ˆåˆ¶å®šç­‰éœ€è¦â€œç­–ç•¥+èµ„æºâ€çš„æ ¸å¿ƒå²—ä½ã€‚
2. è´¢å¸›å®«â€œå»‰è´+ç ´å†›â€æ˜¯å…¸å‹çš„â€œç ´ä¸­æœ‰ç«‹â€æ ¼å±€ï¼ŒçŸ­çº¿é€‚åˆæ•æ‰å¸‚åœºæœºä¼šï¼ˆå¦‚é‡åŒ–äº¤æ˜“ï¼‰ï¼Œé•¿çº¿éœ€é å¤©åºœçš„å®ˆæˆç‰¹è´¨åšé£æ§ï¼Œé¿å…æ¿€è¿›å†³ç­–ã€‚

ã€é©¬å¹´ï¼ˆ2026ï¼‰å¼€è¿æç¤ºã€‘
ä»Šå¹´ä¸ºä¸™åˆé©¬å¹´ï¼Œä¸ä½ å‘½ç›˜å½¢æˆâ€œåˆåˆè‡ªåˆ‘â€ï¼Œæ ¸å¿ƒå½±å“æ˜¯è‡ªæˆ‘é©±åŠ¨å¢å¼ºï¼Œéœ€é˜²å†…è€—ã€‚
â€¢ äº‹ä¸šï¼šå®˜ç¦„å®«ç´«è´ªé‡æµå¹´ç«åŠ©ï¼Œåˆ©äºæ¨å‡ºåˆ›æ–°è¥é”€æ–¹æ¡ˆæˆ–é‡åŒ–ç­–ç•¥ï¼Œä½†éœ€é¿å…â€œè´ªå¤šæ±‚å¿«â€ï¼Œç”¨å¤©åºœçš„ç¨³å¥åšæ”¶å°¾ã€‚
â€¢ è´¢è¿ï¼šç ´å†›å—ç«å±€å‚¬åŠ¨ï¼ŒçŸ­çº¿æœºä¼šå¢å¤šï¼Œå»ºè®®è®¾å®šä¸¥æ ¼æ­¢æŸçº¿ï¼Œé¿å…æƒ…ç»ªåŒ–äº¤æ˜“ã€‚`,
                            
                            love: `ã€äººé™…ä¸æƒ…æ„Ÿï¼šç†æ€§æ²Ÿé€šã€‘
ç¦å¾·å®«å·¨é—¨ä¸»å£èˆŒæ€è¾¨ï¼Œä½ çš„è¡¨è¾¾ä¸å†³ç­–ä»¥é€»è¾‘ä¸ºæ ¸å¿ƒï¼Œé€‚åˆè°ˆåˆ¤ä¸å…¬ä¼—è¡¨è¾¾ã€‚
åœ¨æ„Ÿæƒ…ä¸­ï¼Œä½ æ›´çœ‹é‡å¯¹æ–¹çš„æ™ºåŠ›æ°´å¹³å’Œæ²Ÿé€šæ•ˆç‡ã€‚

ã€é¿å‘æŒ‡å—ã€‘
å·¨é—¨æ˜Ÿå®¹æ˜“å¼•å‘å£èˆŒè¯¯ä¼šã€‚å»ºè®®å¤šå€¾å¬ï¼Œå°‘äº‰è¾©ã€‚ä»Šå¹´ï¼ˆ2026ï¼‰éœ€æ³¨æ„æƒ…ç»ªç®¡ç†ï¼Œé¿å…å› å·¥ä½œå‹åŠ›å¸¦å…¥ç”Ÿæ´»ã€‚`,
                            
                            health: `ã€å¥åº·ï¼šæƒ…ç»ªç®¡ç†ã€‘
ç«å±€è¿‡æ—ºæ˜“å¼•å‘å¿ƒç«ä¸Šç‚ï¼Œéœ€æ³¨æ„å£è…”æºƒç–¡ã€ç¡çœ ä¸è¶³ç­‰é—®é¢˜ã€‚
â€¢ å»ºè®®ï¼šç”¨â€œæ°´â€å±æ€§çš„æ”¾æ¾æ–¹å¼ï¼ˆå¦‚å†¥æƒ³ã€è§„å¾‹é¥®æ°´ã€æ¸¸æ³³ï¼‰å¹³è¡¡ã€‚
â€¢ é©¬å¹´æç¤ºï¼šè‡ªåˆ‘åŠ é‡ç«æ€§ï¼Œéœ€ä¸¥æ§ç†¬å¤œä¸è¾›è¾£é¥®é£Ÿï¼Œç»´æŠ¤å£è…”ä¸å¿ƒè¡€ç®¡å¥åº·ã€‚`
                        };
                    } 
                    
                    // 3. é€šç”¨å…œåº•
                    if (!data) {
                        const seed = (y+m+d+h);
                        data = db.general[seed % db.general.length];
                    }

                    document.getElementById('loading-section').style.display = 'none';
                    const resDiv = document.getElementById('result-section');
                    resDiv.classList.remove('hidden');
                    resDiv.style.display = 'block';

                    // ä½¿ç”¨ pre æ ‡ç­¾ + section-title æ ·å¼ä¼˜åŒ–æ’ç‰ˆ
                    resDiv.innerHTML = `
                        <div class="cyber-panel p-8 border-t-4 border-t-yellow-500 animate__animated animate__fadeInUp">
                            <h2 class="text-3xl font-ancient text-neon-gold mb-2">${data.star}</h2>
                            <p class="text-white text-lg mb-4">â€œ${data.slogan}â€</p>
                            <div class="h-px bg-gray-600 mb-4"></div>
                            <pre>${data.desc}</pre>
                        </div>

                        <div class="cyber-panel p-6 border-l-4 border-l-blue-500 animate__animated animate__fadeInUp animate__delay-1s">
                            <h3 class="section-title">âš¡ äº‹ä¸šç®—åŠ›</h3>
                            <pre>${data.career}</pre>
                        </div>

                        <div class="cyber-panel p-6 border-l-4 border-l-pink-500 animate__animated animate__fadeInUp animate__delay-1s">
                            <h3 class="section-title">â¤ï¸ æƒ…æ„Ÿåè®®</h3>
                            <pre>${data.love}</pre>
                        </div>

                        <div class="cyber-panel p-6 border-l-4 border-l-green-500 animate__animated animate__fadeInUp animate__delay-1s">
                            <h3 class="section-title">ğŸ”‹ ç¡¬ä»¶ç»´æŠ¤</h3>
                            <pre>${data.health}</pre>
                        </div>

                        <div class="text-center pt-8 fade-in-up">
                            <div onclick="location.reload()" class="inline-block px-10 py-3 rounded-full border border-gray-600 text-gray-400 text-xs hover:bg-white/10 hover:text-white transition-colors cursor-pointer select-none">
                                é‡å¯ç³»ç»Ÿ (RESET)
                            </div>
                        </div>
                    `;
                }, 1000);
            } catch(e) {
                showToast("Runtime Error: " + e.message);
            }
        };

        let bindAttempt = 0;
        const binder = setInterval(() => {
            const btn = document.getElementById('start-btn');
            if(btn) {
                btn.onclick = null;
                const handler = function(e) { e.preventDefault(); window.runLogic(); };
                btn.addEventListener('click', handler);
                btn.addEventListener('touchend', handler);
                clearInterval(binder);
            }
            bindAttempt++;
            if(bindAttempt > 50) clearInterval(binder);
        }, 100);
    </script>
</body>
</html>
