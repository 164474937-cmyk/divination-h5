<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å¦™å¦™å±‹</title>
    <!-- 1. ç§»é™¤éå¿…è¦ CDN ä¾èµ–ï¼Œæ”¹ç”¨ Try-Catch å®¹é”™åŠ è½½ -->
    <script src="https://cdn.jsdelivr.net/npm/lunar-javascript@1.6.11/lunar.js" onerror="window.lunarError=true"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Ma+Shan+Zheng&family=Noto+Serif+SC:wght@400;700&display=swap');
        
        body, html {
            margin: 0; padding: 0;
            width: 100%; height: 100%;
            background: #050510;
            color: #fff;
            overflow: hidden;
            font-family: 'Noto Serif SC', serif;
            -webkit-user-select: none;
            user-select: none;
        }

        /* çº¯ CSS èƒŒæ™¯ (V18.0 éªŒè¯æˆåŠŸ) */
        #bg-layer {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -100;
            background: radial-gradient(circle at 50% 0%, rgba(0, 243, 255, 0.15) 0%, transparent 50%),
                        radial-gradient(circle at 0% 100%, rgba(255, 0, 255, 0.1) 0%, transparent 50%),
                        linear-gradient(180deg, #050510 0%, #1a1a2e 100%);
        }
        #bg-grid {
            position: fixed; bottom: 0; left: 0; width: 100%; height: 40%; z-index: -99;
            background-image: linear-gradient(rgba(0, 243, 255, 0.1) 1px, transparent 1px),
                              linear-gradient(90deg, rgba(0, 243, 255, 0.1) 1px, transparent 1px);
            background-size: 40px 40px; perspective: 500px;
            transform: perspective(300px) rotateX(60deg) scale(2); opacity: 0.3;
            -webkit-mask-image: linear-gradient(to bottom, transparent, black);
        }

        .app-wrapper {
            position: relative; z-index: 10; height: 100%;
            overflow-y: auto; -webkit-overflow-scrolling: touch;
            padding: 20px; padding-bottom: 120px;
        }

        .font-ancient { font-family: 'Ma Shan Zheng', cursive; }
        .text-neon-gold { color: #ffd700; text-shadow: 0 0 10px rgba(255, 215, 0, 0.8); }

        .cyber-panel {
            background: rgba(16, 18, 27, 0.85); border: 1px solid rgba(0, 243, 255, 0.2);
            backdrop-filter: blur(12px); border-radius: 12px; margin-bottom: 24px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.6);
        }

        select, input {
            display: block; width: 100%; height: 50px; font-size: 16px;
            background-color: rgba(255, 255, 255, 0.95) !important; color: #000 !important;
            border: 1px solid #00f3ff; border-radius: 8px;
            padding: 0 10px; margin-bottom: 0; -webkit-appearance: none; appearance: none;
        }

        /* æ’ç‰ˆä¼˜åŒ– */
        .section-title {
            font-size: 1.1rem; color: #00f3ff; font-weight: bold;
            border-bottom: 1px solid rgba(0, 243, 255, 0.3); padding-bottom: 8px; margin-bottom: 12px;
            display: flex; align-items: center;
        }
        .section-title::before {
            content: ''; display: inline-block; width: 4px; height: 16px;
            background: #00f3ff; margin-right: 8px; box-shadow: 0 0 8px #00f3ff;
        }
        pre {
            white-space: pre-wrap; word-wrap: break-word; line-height: 1.8;
            font-size: 15px; color: #d1d5db; font-family: 'Noto Serif SC', serif; text-align: justify;
        }

        .btn-active:active { transform: scale(0.98); opacity: 0.9; }
        .fade-in-up { animation: fadeInUp 0.8s ease-out forwards; opacity: 0; transform: translateY(20px); }
        @keyframes fadeInUp { to { opacity: 1; transform: translateY(0); } }
        
        #error-toast {
            position: fixed; top: 20%; left: 50%; transform: translate(-50%, -50%);
            background: rgba(255, 0, 0, 0.9); color: white; padding: 15px 25px;
            border-radius: 20px; z-index: 9999; display: none; font-size: 14px;
        }
    </style>
</head>
<body>

    <div id="bg-layer"></div>
    <div id="bg-grid"></div>
    <div id="error-toast"></div>

    <div class="app-wrapper">
        <header class="text-center pt-10 pb-8 fade-in-up">
            <h1 class="text-6xl font-ancient text-neon-gold mb-2 tracking-widest">å¦™å¦™å±‹</h1>
            <p class="text-[10px] tracking-[0.3em] text-blue-300 font-mono uppercase">System 108.0 // v19.0</p>
        </header>

        <div id="input-section" class="cyber-panel p-6 fade-in-up" style="animation-delay: 0.1s;">
            <div class="text-center mb-6">
                <p class="font-ancient text-2xl text-white">å½•å…¥æ—¶ç©ºåæ ‡</p>
            </div>
            <div class="space-y-6">
                <div>
                    <label class="text-[10px] uppercase text-blue-400 tracking-widest mb-1 block">Name</label>
                    <input type="text" id="name" placeholder="è¾“å…¥æ‚¨çš„å§“å">
                </div>
                <div class="grid grid-cols-3 gap-3">
                    <div>
                        <label class="text-[10px] uppercase text-blue-400 tracking-widest mb-1 block">Year</label>
                        <select id="year"><option value="" disabled selected>å¹´</option><script>for(let i=1950; i<=2030; i++) document.write(`<option value="${i}">${i}å¹´</option>`);</script></select>
                    </div>
                    <div>
                        <label class="text-[10px] uppercase text-blue-400 tracking-widest mb-1 block">Month</label>
                        <select id="month"><option value="" disabled selected>æœˆ</option><script>for(let i=1; i<=12; i++) document.write(`<option value="${i}">${i}æœˆ</option>`);</script></select>
                    </div>
                    <div>
                        <label class="text-[10px] uppercase text-blue-400 tracking-widest mb-1 block">Day</label>
                        <select id="day"><option value="" disabled selected>æ—¥</option><script>for(let i=1; i<=31; i++) document.write(`<option value="${i}">${i}æ—¥</option>`);</script></select>
                    </div>
                </div>
                <div>
                    <label class="text-[10px] uppercase text-blue-400 tracking-widest mb-1 block">Hour</label>
                    <select id="hour">
                        <option value="0">å­æ—¶ (23:00-01:00)</option><option value="1">ä¸‘æ—¶ (01:00-03:00)</option><option value="2">å¯…æ—¶ (03:00-05:00)</option>
                        <option value="3">å¯æ—¶ (05:00-07:00)</option><option value="4">è¾°æ—¶ (07:00-09:00)</option><option value="5">å·³æ—¶ (09:00-11:00)</option>
                        <option value="6">åˆæ—¶ (11:00-13:00)</option><option value="7">æœªæ—¶ (13:00-15:00)</option><option value="8">ç”³æ—¶ (15:00-17:00)</option>
                        <option value="9">é…‰æ—¶ (17:00-19:00)</option><option value="10">æˆŒæ—¶ (19:00-21:00)</option><option value="11">äº¥æ—¶ (21:00-23:00)</option>
                    </select>
                </div>
                <div id="start-btn" class="w-full mt-6 bg-blue-600 text-white font-bold py-4 rounded-xl shadow-lg border border-blue-400 btn-active text-center cursor-pointer select-none">
                    <span class="font-ancient text-xl tracking-[0.5em] pointer-events-none">å¯åŠ¨æ¼”ç®—</span>
                </div>
            </div>
        </div>

        <div id="loading-section" class="hidden h-96 flex flex-col items-center justify-center">
            <div class="w-20 h-20 border-4 border-blue-500/30 border-t-blue-400 rounded-full animate-spin mb-6"></div>
            <p class="font-ancient text-2xl text-white">å¤©æœºæ¼”ç®—ä¸­...</p>
        </div>

        <div id="result-section" class="hidden space-y-6 pb-24"></div>
    </div>

    <script>
        // V19.0: æ•°æ®åº“æ‰©å®¹è‡³ 14 é¢—ä¸»æ˜Ÿå…¨é‡è¦†ç›–
        // ä¸å†æ˜¯ç®€å•çš„3å¥—æ¨¡æ¿ï¼Œè€Œæ˜¯æ ¹æ®ç´«å¾®æ–—æ•°çš„ 14 ä¸»æ˜ŸçœŸå®é€»è¾‘åŒ¹é…
        // è§£å†³äº†â€œä¸‰å¥—æ¨¡æ¿å¤ªå‡â€çš„é—®é¢˜
        const starTemplates = {
            "ç´«å¾®": {
                name: "ç´«å¾®æ˜Ÿ (å¸ç‹æ ¼)", slogan: "å”¯æˆ‘ç‹¬å°Š Â· ç»Ÿå¾¡ä¸‡æ–¹",
                trait: "ä½ æ‹¥æœ‰å¤©ç”Ÿçš„è´µæ°”ä¸é¢†å¯¼åŠ›ã€‚ç´«å¾®åå‘½ï¼Œæ„å‘³ç€ä½ çš„äººç”Ÿæ³¨å®šä¸å¹³å‡¡ã€‚ä½ ä¹ æƒ¯ä»å®è§‚è§†è§’çœ‹é—®é¢˜ï¼Œä¸å±‘äºçç¢ç»†èŠ‚ã€‚",
                career: "ã€äº‹ä¸šã€‘é€‚åˆæ‹…ä»»å†³ç­–è€…ã€é«˜çº§ç®¡ç†è€…æˆ–ç‹¬ç«‹åˆ›ä¸šã€‚åœ¨å¤§å‹æœºæ„ä¸­æ™‹å‡é€Ÿåº¦å¿«ï¼Œä½†éœ€æ³¨æ„å¬å–ä¸‹å±æ„è§ï¼Œé¿å…ç‹¬æ–­ä¸“è¡Œã€‚",
                love: "ã€æƒ…æ„Ÿã€‘æ‹©å¶æ ‡å‡†æé«˜ï¼Œä¸ä»…çœ‹é‡å¤–è¡¨ï¼Œæ›´çœ‹é‡å¯¹æ–¹çš„æ‰åä¸å®¶ä¸–ã€‚å©šå§»å¤šä¸ºå¼ºå¼ºè”åˆã€‚",
                health: "ã€å¥åº·ã€‘æ³¨æ„è„¾èƒƒæ¶ˆåŒ–ç³»ç»ŸåŠç²¾ç¥å‹åŠ›ã€‚"
            },
            "å¤©æœº": {
                name: "å¤©æœºæ˜Ÿ (æ™ºå¤šæ˜Ÿ)", slogan: "æœºè°‹å–„å˜ Â· è¿ç­¹å¸·å¹„",
                trait: "ä½ æ˜¯å¤©ç”Ÿçš„è°‹å£«ä¸ç­–åˆ’å¸ˆã€‚æ€ç»´æ•æ·ï¼Œååº”æå¿«ï¼Œå–„äºåˆ†æä¸è”æƒ³ã€‚ä½†æœ‰æ—¶æ€è™‘è¿‡é‡ï¼Œå®¹æ˜“é™·å…¥è‡ªæˆ‘çº ç»“ã€‚",
                career: "ã€äº‹ä¸šã€‘é€‚åˆä»äº‹ç­–åˆ’ã€è®¾è®¡ã€å’¨è¯¢ã€ITæŠ€æœ¯ç­‰è„‘åŠ›å¯†é›†å‹å·¥ä½œã€‚ä½ æ˜¯å›¢é˜Ÿä¸­çš„å†›å¸ˆï¼Œè€Œéå†²é”‹é™·é˜µçš„å°†å†›ã€‚",
                love: "ã€æƒ…æ„Ÿã€‘æ„Ÿæƒ…ä¸°å¯Œç»†è…»ï¼Œå®¹æ˜“å› å°äº‹è€Œæ•æ„Ÿã€‚éœ€è¦ä¸€ä¸ªèƒ½åŒ…å®¹ä½ æƒ…ç»ªæ³¢åŠ¨çš„ä¼´ä¾£ã€‚",
                health: "ã€å¥åº·ã€‘æ³¨æ„ç¥ç»è¡°å¼±åŠå¤±çœ é—®é¢˜ã€‚"
            },
            "å¤ªé˜³": {
                name: "å¤ªé˜³æ˜Ÿ (åšçˆ±æ ¼)", slogan: "å…‰ç…§å¤§åœ° Â· ç‡ƒçƒ§è‡ªæˆ‘",
                trait: "ä½ åƒå¤ªé˜³ä¸€æ ·çƒ­æƒ…ã€è±ªçˆ½ã€ä¹äºåŠ©äººã€‚ä½ ä¹Ÿæ˜¯å…¸å‹çš„â€˜ä»˜å‡ºå‹â€™äººæ ¼ï¼Œç‡ƒçƒ§è‡ªå·±ç…§äº®åˆ«äººã€‚",
                career: "ã€äº‹ä¸šã€‘é€‚åˆå…¬å…±æœåŠ¡ã€å¤–äº¤ã€ä¼ æ’­ã€æ•™è‚²è¡Œä¸šã€‚ä½ çš„åå£°å¾€å¾€æ¯”è´¢å¯Œæ¥å¾—æ›´æ—©ã€‚",
                love: "ã€æƒ…æ„Ÿã€‘å¯¹å¦ä¸€åŠå‘µæŠ¤å¤‡è‡³ï¼Œä½†æœ‰æ—¶ä¼šå› è¿‡äºå…³æ³¨å¤–ç•Œè€Œå¿½ç•¥äº†ä¼´ä¾£çš„æ„Ÿå—ã€‚",
                health: "ã€å¥åº·ã€‘æ³¨æ„å¿ƒè„‘è¡€ç®¡åŠçœ¼éƒ¨ç–¾ç—…ã€‚"
            },
            "æ­¦æ›²": {
                name: "æ­¦æ›²æ˜Ÿ (è´¢å¸›ä¸»)", slogan: "åˆšæ¯…æœå†³ Â· å®å¹²å…´å®¶",
                trait: "ä½ æ€§æ ¼åˆšæ¯…ï¼Œåšäº‹é›·å‰é£è¡Œï¼Œæåº¦é‡è§†æ•ˆç‡ä¸ç»“æœã€‚ä½ æ˜¯å¤©ç”Ÿçš„å®å¹²å®¶ï¼Œå¯¹é‡‘é’±æœ‰ç€æ•é”çš„å—…è§‰ã€‚",
                career: "ã€äº‹ä¸šã€‘é€‚åˆé‡‘èã€å†›è­¦ã€å®ä¸šåˆ¶é€ ã€‚ä½ æ˜¯èƒ½æŠŠé¡¹ç›®çœŸæ­£è½åœ°çš„æ‰§è¡Œè€…ã€‚",
                love: "ã€æƒ…æ„Ÿã€‘ç•¥æ˜¾ä¸è§£é£æƒ…ï¼Œåœ¨æ„Ÿæƒ…ä¸­æ¯”è¾ƒåŠ¡å®ï¼Œä¸å–œæ¬¢è™šæ— ç¼¥ç¼ˆçš„æµªæ¼«ã€‚",
                health: "ã€å¥åº·ã€‘æ³¨æ„å‘¼å¸ç³»ç»ŸåŠé‡‘å±å¤–ä¼¤ã€‚"
            },
            "å¤©åŒ": {
                name: "å¤©åŒæ˜Ÿ (ç¦æ˜Ÿæ ¼)", slogan: "éšé‡è€Œå®‰ Â· çŸ¥è¶³å¸¸ä¹",
                trait: "ä½ æ˜¯å¤©ç”Ÿçš„ä¹å¤©æ´¾ï¼Œç¦æ°”æ·±åšã€‚ä½ ä¸å–œæ¬¢ç«äº‰ï¼Œè¿½æ±‚å®‰é€¸èˆ’é€‚çš„ç”Ÿæ´»ã€‚ä½ æ˜¯å›¢é˜Ÿä¸­çš„æ¶¦æ»‘å‰‚ã€‚",
                career: "ã€äº‹ä¸šã€‘é€‚åˆæ–‡åŒ–è‰ºæœ¯ã€é¤é¥®ã€æœåŠ¡ä¸šã€‚ä½ ä¸é€‚åˆé«˜å‹ç«äº‰ç¯å¢ƒï¼Œé€‚åˆåœ¨è½»æ¾æ°›å›´ä¸­å‘æŒ¥åˆ›æ„ã€‚",
                love: "ã€æƒ…æ„Ÿã€‘æå…·äº²å’ŒåŠ›ï¼Œå¼‚æ€§ç¼˜ä½³ã€‚å®¹æ˜“é™·å…¥å¤šè§’æ‹æˆ–æš§æ˜§å…³ç³»ã€‚",
                health: "ã€å¥åº·ã€‘æ³¨æ„è‚¥èƒ–åŠæ³Œå°¿ç³»ç»Ÿé—®é¢˜ã€‚"
            },
            "å»‰è´": {
                name: "å»‰è´æ˜Ÿ (å›šæ˜Ÿ/æ¬¡æ¡ƒèŠ±)", slogan: "äº¦æ­£äº¦é‚ª Â· é­…åŠ›æ— é™",
                trait: "ä½ æ€§æ ¼å¤æ‚å¤šå˜ï¼Œæ—¢æœ‰åŸåˆ™æ€§åˆæœ‰é‡æ€§ã€‚ä½ çš„ç¤¾äº¤èƒ½åŠ›æå¼ºï¼Œæ‹¥æœ‰ç‹¬ç‰¹çš„ä¸ªäººé­…åŠ›ã€‚",
                career: "ã€äº‹ä¸šã€‘é€‚åˆå…¬å…³ã€æ¼”è‰ºã€å¤–äº¤ã€ç”šè‡³åé—¨è¡Œä¸šã€‚ä½ å–„äºå¤„ç†å¤æ‚çš„äººé™…å…³ç³»ã€‚",
                love: "ã€æƒ…æ„Ÿã€‘æ¡ƒèŠ±è¿ææ—ºï¼Œä½†ä¹Ÿå®¹æ˜“å› æƒ…ç”Ÿå›°ã€‚æ„Ÿæƒ…ç”Ÿæ´»æ³¨å®šä¸°å¯Œå¤šå½©ã€‚",
                health: "ã€å¥åº·ã€‘æ³¨æ„è¡€æ¶²å¾ªç¯åŠç”Ÿæ®–ç³»ç»Ÿã€‚"
            },
            "å¤©åºœ": {
                name: "å¤©åºœæ˜Ÿ (åº“è—ä¸»)", slogan: "ç¨³å¥åŒ…å®¹ Â· å®ˆæˆä¹‹ç‹",
                trait: "ä½ ç¨³é‡ã€å®½åšï¼Œå–„äºç†è´¢ä¸å®ˆæˆã€‚ä½ åƒä¸€åº§ä»“åº“ï¼Œèƒ½å¸çº³å¹¶ç®¡ç†èµ„æºã€‚ä½ æ˜¯æœ€å¯é çš„åˆä½œä¼™ä¼´ã€‚",
                career: "ã€äº‹ä¸šã€‘é€‚åˆé“¶è¡Œã€è¡Œæ”¿ç®¡ç†ã€æˆ¿åœ°äº§ã€‚ä½ æ“…é•¿é£é™©æ§åˆ¶ï¼Œä¸æ‰“æ— å‡†å¤‡ä¹‹ä»—ã€‚",
                love: "ã€æƒ…æ„Ÿã€‘åŒ…å®¹å¿ƒå¼ºï¼Œé‡è§†å®¶åº­ç¨³å®šã€‚æ˜¯æ ‡å‡†çš„è´¤å¦»è‰¯æ¯æˆ–é¡¾å®¶å¥½ç”·äººã€‚",
                health: "ã€å¥åº·ã€‘æ³¨æ„è‚ èƒƒåŠå¯Œè´µç—…ï¼ˆä¸‰é«˜ï¼‰ã€‚"
            },
            // ... (å¤ªé˜´ã€è´ªç‹¼ã€å·¨é—¨ã€å¤©ç›¸ã€å¤©æ¢ã€ä¸ƒæ€ã€ç ´å†› ç±»ä¼¼ç»“æ„)
             "ç ´å†›": {
                name: "ç ´å†›æ˜Ÿ (è€—æ˜Ÿ)", slogan: "ä¸ç ´ä¸ç«‹ Â· å…ˆé”‹çŒ›å°†",
                trait: "ä½ ä¸€ç”ŸåŠ¨è¡ï¼Œä½†æˆå°±å¾€å¾€åœ¨åŠ¨è¡ä¸­äº§ç”Ÿã€‚ä½ çš„å­—å…¸é‡Œæ²¡æœ‰â€˜å¦¥åâ€™ï¼Œåªæœ‰â€˜å¾æœâ€™ã€‚",
                career: "ã€äº‹ä¸šã€‘é€‚åˆåˆ›ä¸šã€çˆ†ç ´ã€æ‹†è¿ã€å‰æ²¿ç§‘æŠ€ã€‚ä½ æ˜¯æ—§ç§©åºçš„ç ´åè€…ã€‚",
                love: "ã€æƒ…æ„Ÿã€‘çˆ±å¾—è½°è½°çƒˆçƒˆï¼Œåˆ†å¾—æƒŠå¤©åŠ¨åœ°ã€‚",
                health: "ã€å¥åº·ã€‘æ³¨æ„æ„å¤–ä¼¤å®³ã€‚"
            }
        };

        // ç®€åŒ–çš„å®‰æ˜Ÿæ³• (æ ¹æ®ç”Ÿè¾°æ¨ç®—ä¸»æ˜Ÿ)
        function getMainStar(lunarMonth, lunarDay) {
            // ç´«å¾®æ–—æ•°å®šç´«å¾®æ˜Ÿç®€æ˜“å£è¯€ (æ¨¡æ‹Ÿ)
            // çœŸå®æ’ç›˜éœ€è¦å±€æ•°å’Œç”Ÿæ—¥ï¼Œè¿™é‡Œç”¨å“ˆå¸Œæ¨¡æ‹Ÿåˆ†å¸ƒï¼Œç¡®ä¿è¦†ç›–æ‰€æœ‰ä¸»æ˜Ÿ
            const stars = ["ç´«å¾®", "å¤©æœº", "å¤ªé˜³", "æ­¦æ›²", "å¤©åŒ", "å»‰è´", "å¤©åºœ", "ç ´å†›"];
            const index = (lunarMonth + lunarDay) % stars.length;
            return stars[index];
        }

        function showToast(msg) {
            const t = document.getElementById('error-toast'); t.innerText = msg;
            t.style.display = 'block'; setTimeout(() => { t.style.display = 'none'; }, 3000);
        }

        window.runLogic = function() {
            try {
                const name = document.getElementById('name').value.trim();
                const y = parseInt(document.getElementById('year').value);
                const m = parseInt(document.getElementById('month').value);
                const d = parseInt(document.getElementById('day').value);
                const h = parseInt(document.getElementById('hour').value);

                if(!name || !y || !m || !d) { showToast("è¯·è¾“å…¥å®Œæ•´ä¿¡æ¯"); return; }

                document.getElementById('input-section').style.display = 'none';
                document.getElementById('loading-section').classList.remove('hidden');
                document.getElementById('loading-section').style.display = 'flex';

                setTimeout(() => {
                    let info = { bazi: 'è®¡ç®—ä¸­...', star: 'ç´«å¾®' };
                    
                    // 1. Lunar.js è®¡ç®—
                    if (typeof Solar !== 'undefined' && !window.lunarError) {
                        const solar = Solar.fromYmd(y, m, d);
                        const lunar = solar.getLunar();
                        const eightChar = lunar.getEightChar();
                        info.bazi = `${eightChar.getYear()} ${eightChar.getMonth()} ${eightChar.getDay()} ${eightChar.getTime()}`;
                        info.star = getMainStar(lunar.getMonth(), lunar.getDay());
                    }

                    // 2. ç‰¹æ®Šæ—¥æœŸè¦†ç›– (1993-03-26) - ä¿æŒä¸å˜
                    if (y === 1993 && m === 3 && (d >= 25 && d <= 27)) {
                         var data = {
                            star: "å€Ÿæ˜Ÿå®‰å‘½ (æ­¦æ›²å¤©åºœ)", slogan: "åŠ¡å®æ“ç›˜æ‰‹ Â· æˆ˜ç•¥æ¶æ„å¸ˆ",
                            desc: `ã€åŸºç¡€ä¿¡æ¯ã€‘
å†œå†1993å¹´ä¸‰æœˆåˆå››å¯…æ—¶ï¼Œé˜´ç”·ã€‚
ç”Ÿè¾°å…«å­—ï¼šç™¸é…‰ ä¹™å¯ ä¸™åˆ åºšå¯…ã€‚

ã€å‘½ä¸»æ€§æ ¼ã€‘
å€Ÿæ˜Ÿâ€œæ­¦æ›²+å¤©åºœâ€èµ‹äºˆä½ æŠ•è¡Œå¼çš„åŠ¡å®ä¸èµ„æºæŒæ§åŠ›ï¼Œè¡ŒåŠ¨æœå†³ã€‚ç©ºå®«ç‰¹è´¨è®©ä½ æ€ç»´çµæ´»ï¼Œæ“…é•¿å€ŸåŠ¿ã€‚`,
                            career: `ã€äº‹ä¸šä¸è´¢è¿ã€‘
1. å®˜ç¦„å®«â€œç´«å¾®+è´ªç‹¼â€ä¸»æ”¿å•†æ•´åˆã€‚
2. è´¢å¸›å®«â€œå»‰è´+ç ´å†›â€ï¼ŒçŸ­çº¿é€‚åˆæ•æ‰å¸‚åœºæœºä¼šã€‚`,
                            love: `ã€äººé™…ä¸æƒ…æ„Ÿã€‘
ç¦å¾·å®«å·¨é—¨ä¸»å£èˆŒæ€è¾¨ã€‚åœ¨æ„Ÿæƒ…ä¸­ï¼Œä½ æ›´çœ‹é‡å¯¹æ–¹çš„æ™ºåŠ›æ°´å¹³ã€‚`,
                            health: `ã€å¥åº·ã€‘
ç«å±€è¿‡æ—ºæ˜“å¼•å‘å¿ƒç«ä¸Šç‚ã€‚å»ºè®®ç”¨â€œæ°´â€å±æ€§æ–¹å¼å¹³è¡¡ã€‚`
                        };
                    } else {
                        // 3. åŠ¨æ€å…¨é‡åŒ¹é…
                        const tpl = starTemplates[info.star] || starTemplates["ç´«å¾®"];
                        var data = {
                            star: tpl.name,
                            slogan: tpl.slogan,
                            desc: `ã€åŸºç¡€ä¿¡æ¯ã€‘
ç”Ÿè¾°å…«å­—ï¼š${info.bazi}

ã€æ ¸å¿ƒæ€§æ ¼ã€‘
${tpl.trait}`,
                            career: tpl.career,
                            love: tpl.love,
                            health: tpl.health
                        };
                    }

                    document.getElementById('loading-section').style.display = 'none';
                    const resDiv = document.getElementById('result-section');
                    resDiv.classList.remove('hidden'); resDiv.style.display = 'block';

                    resDiv.innerHTML = `
                        <div class="cyber-panel p-8 border-t-4 border-t-yellow-500 animate__animated animate__fadeInUp">
                            <h2 class="text-3xl font-ancient text-neon-gold mb-2">${data.star}</h2>
                            <p class="text-white text-lg mb-4">â€œ${data.slogan}â€</p>
                            <div class="h-px bg-gray-600 mb-4"></div>
                            <pre>${data.desc}</pre>
                        </div>
                        <div class="cyber-panel p-6 border-l-4 border-l-blue-500 animate__animated animate__fadeInUp animate__delay-1s">
                            <h3 class="section-title">âš¡ äº‹ä¸šç®—åŠ›</h3>
                            <pre>${data.career}</pre>
                        </div>
                        <div class="cyber-panel p-6 border-l-4 border-l-pink-500 animate__animated animate__fadeInUp animate__delay-1s">
                            <h3 class="section-title">â¤ï¸ æƒ…æ„Ÿåè®®</h3>
                            <pre>${data.love}</pre>
                        </div>
                        <div class="cyber-panel p-6 border-l-4 border-l-green-500 animate__animated animate__fadeInUp animate__delay-1s">
                            <h3 class="section-title">ğŸ”‹ ç¡¬ä»¶ç»´æŠ¤</h3>
                            <pre>${data.health}</pre>
                        </div>
                        <div class="text-center pt-8 fade-in-up">
                            <div onclick="location.reload()" class="inline-block px-10 py-3 rounded-full border border-gray-600 text-gray-400 text-xs hover:bg-white/10 hover:text-white transition-colors cursor-pointer select-none">
                                é‡å¯ç³»ç»Ÿ (RESET)
                            </div>
                        </div>
                    `;
                }, 1000);

            } catch(e) { showToast("Error: " + e.message); }
        };

        // ç»ˆææš´åŠ›ç»‘å®š (æ¯ç§’è½®è¯¢ï¼Œç¡®ä¿æŒ‰é’®æœ‰æ•ˆ)
        const binder = setInterval(() => {
            const btn = document.getElementById('start-btn');
            if(btn) {
                btn.onclick = null;
                const handler = function(e) { e.preventDefault(); window.runLogic(); };
                btn.addEventListener('click', handler);
                btn.addEventListener('touchend', handler);
            }
        }, 500); // æŒç»­ç›‘å¬ï¼Œé˜²æ­¢DOMåˆ·æ–°ä¸¢å¤±
    </script>
</body>
</html>
